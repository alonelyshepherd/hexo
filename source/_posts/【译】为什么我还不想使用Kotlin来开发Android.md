---
title: ã€è¯‘ã€‘ä¸ºä»€ä¹ˆæˆ‘è¿˜ä¸æƒ³ä½¿ç”¨Kotlinæ¥å¼€å‘Android
date: 2016-03-22 22:07:06
tags:
---
åŸæ–‡é“¾æ¥[åœ¨æ­¤](http://gold.xitu.io/entry/56ea7118731956005d037ef1)ã€‚

å°½ç®¡Kotlinåœ¨è®¸å¤šæ–¹é¢éƒ½ä¼˜äºJavaï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰é‡å¤§ç¼ºé™·çš„ã€‚
>è¯·æŠŠå®ƒå½“æˆä¸ªäººæ„è§ï¼Œå¦‚æœä½ æœ‰è¿™äº›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆè¯·åœ¨æ–‡ååˆ—å‡º

### 1ï¼‰ç¼–è¯‘ç¼“æ…¢
å°é¡¹ç›®ï¼ˆä¸€å…±çº¦100ä¸ªclassï¼Œå¤§éƒ¨åˆ†æ˜¯Kotlinï¼‰éœ€è¦çº¦1åˆ†é’Ÿçš„æ—¶é—´æ¥ç¼–è¯‘ã€‚è¿™æ˜¯æ— æ³•æ¥å—çš„ã€‚
[https://youtrack.jetbrains.com/issue/KT-6246](https://youtrack.jetbrains.com/issue/KT-6246)

### 2) Kotlin IDEAæ’ä»¶çš„æ€§èƒ½
IDEA(Android Studio)ä¸­Kotlinçš„è¯­æ³•åˆ†æå’Œé«˜äº®å¸¸å¸¸åœ¨è¾“å…¥çš„æ—¶å€™é€ æˆå¼€å‘æœºå¡é¡¿ï¼Œä¸å¯æ¥å—ã€‚

### 3) æ³¨è§£å¤„ç†
æœ‰æ—¶å€™ä¼šéšæœºçš„å‡ºé”™ç„¶åå°±å¿…é¡»`clean`ã€‚å‡ ä¹æ¯å¤©æˆ‘éƒ½ä¼šä»ä¸åŒåœ°æ–¹çœ‹åˆ°æŠ±æ€¨ï¼Œæˆ‘ä¸æ˜¯ä¸€ä¸ªäººã€‚

### 4) ç”¨Mockitoæ¥æ¨¡æ‹ŸKotlinç±»å¾ˆç—›è‹¦
åœ¨Kotlinä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿é»˜è®¤éƒ½æ˜¯`final`çš„ï¼šç±»ï¼Œæ–¹æ³•ï¼Œç­‰ç­‰ã€‚æˆ‘å–œæ¬¢è¿™ä¸€ç‚¹å› ä¸ºå®ƒå¼ºåˆ¶è¦æ±‚ä¸å˜æ€§->æ›´å°‘bugã€‚ä½†æ˜¯å®ƒåŒæ—¶ä½¿å¾—é€šè¿‡`Mockito`ï¼ˆJVMä¸–ç•Œçš„ä¸€ç§æ ‡å‡†ï¼‰æ¨¡æ‹Ÿå˜çš„å¾ˆç—›è‹¦è€Œä¸”èƒŒç¦»äº†è¯­è¨€è®¾è®¡çš„æ–¹å‘ã€‚

æ˜¯çš„ï¼ŒPowerMockæ˜¯ä¸€ç§å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®ƒè·Ÿä¸€äº›Robolectricè¿™ç±»çš„å·¥å…·å…³è”è€Œä¸”æ€»å¾—æ¥è¯´æœ‰ä¸€ä¸ªå¾ˆå¥½çš„åŸåˆ™å°±æ˜¯ä½ ä¸åº”è¯¥æ¨¡æ‹Ÿfinalç±»å’Œfinalæ–¹æ³•ã€‚

æˆ‘ç†è§£Javaçš„é—®é¢˜ï¼šæ‰€æœ‰çš„ä¸œè¥¿ä»è®¾è®¡ä¸Šå°±ä¸æ˜¯finalçš„ï¼Œä½†æ˜¯åŒæ—¶**æˆ‘ä¸å¸Œæœ›ä»…ä»…ä¸ºäº†æµ‹è¯•å»ä¿®æ”¹ä»£ç **

### 5) ç›®å‰è¿˜æ²¡æœ‰Kotlinçš„é™æ€åˆ†æå·¥å…·
æ˜¯çš„ï¼Œ`kotlinc`ä¸ºä»£ç å¢åŠ æ¯”`javac`æ›´å¤šå®‰å…¨æ€§ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³ä½¿ç¼–è¯‘å™¨è¾¾åˆ°æ›´é«˜çš„æ€§èƒ½çš„è¯ï¼Œä½ ä¸ä¼šæƒ³è®©å®ƒå˜æˆé™æ€åˆ†æå™¨çš„ã€‚

é™æ€ä»£ç åˆ†æå·¥å…·å¯¹CIæ¥è¯´å¾ˆå¥½ï¼Œä½†æ˜¯ä½ ä¹Ÿè®¸ä¸æƒ³åœ¨æœ¬åœ°å¼€å‘æ—¶æ¯æ¬¡ç‚¹å‡»IDEä¸Šçš„`run`æŒ‰é’®éƒ½è¿è¡Œå®ƒ

Javaæœ‰ï¼šFindBugsï¼ŒPMDï¼ŒCheckstyleï¼ŒSonarqubeï¼ŒError Proneï¼ŒFB inferã€‚

Kotlinæœ‰ï¼š`kotlinc`ã€‚

> ä¸Šé¢çš„è§‚ç‚¹æ˜¯å®¢è§‚çš„ï¼Œæˆ‘å¸Œæœ›ã€‚ä¸‹é¢çš„è§‚ç‚¹æ›´åŠ ä¸»è§‚ã€‚

### 6) `==`æ˜¯`equals()`è€Œä¸æ˜¯å¼•ç”¨æ¯”è¾ƒ
å¦‚æœKotlinæ˜¯â€œæ›´å¥½çš„â€Javaæˆ–æ˜¯â€œJavaåƒäº†å…´å¥‹å‰‚â€é‚£ä¹ˆå®ƒå°±åº”è¯¥æ›´å¥½ï¼Œè€Œä¸æ˜¯ç›¸åã€‚

æƒ³è±¡ä¸€ä¸‹ä½ æ­£åœ¨ç”¨Kotliné‡å†™Javaå·¥ç¨‹ï¼Œä½ çš„å·¥ç¨‹ä¸­ä¼šåŒæ—¶æœ‰Javaå’ŒKotlinä»£ç ã€‚

ä½ å°†ä¼šè¯»å†™å·¥ä½œèµ·æ¥ä¸åŒçš„åŒä¸€å¥—ä»£ç ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä¸å–œæ¬¢Groovyçš„ä¸€ä¸ªåŸå› ã€‚

### 7) å¦‚æœä½¿ç”¨ä¸å½“è¿ç®—ç¬¦é‡è½½ä¼šé€ æˆä¸¥é‡åæœ
è¯´æ˜1ï¼šå°†æ¥ä½ ä¼šéœ€è¦å»å¤„ç†è€æ—§çš„Kotlinä»£ç åŸºçº¿
è¯´æ˜2ï¼šé€šè¿‡æ‰©å±•åŠŸèƒ½ä½ å¯ä»¥ä¸º**å·²æœ‰**çš„Javaç±»æ·»åŠ è¿ç®—ç¬¦é‡è½½

ç°åœ¨æƒ³è±¡ä¸€ä¸‹ä½ çœ‹åˆ°ä¸€äº›è¯¸å¦‚`val person3 = person1 + person2`è¿™æ ·å·²å†™å¥½çš„ä»£ç éœ€è¦å¤„ç†ã€‚

ä½ å·¥ä½œçš„æ¯ä¸ªå·¥ç¨‹å¯¹äºç›¸åŒçš„ç±»éƒ½å¯èƒ½æœ‰è‡ªå·±çš„è¿ç®—ç¬¦æ„ä¹‰ğŸ˜¿

è¿ç®—ç¬¦é‡è½½æ˜¯æœ‰äº‰è®®çš„ï¼Œè¿™äº›é“¾æ¥ä¹Ÿè®¸èƒ½å¸®åŠ©ä½ å†³å®šï¼ˆä¸æ˜¯æ‰€æœ‰çš„éƒ½æŒ‡å‘åŒä¸€ä¸ªç»“è®ºï¼‰ï¼š

- [Operator Overloading Considered Harmful](http://cafe.elharo.com/programming/operator-overloading-considered-harmful)
- [Operator Overloading Ad Absurdum](http://james-iry.blogspot.ru/2009/03/operator-overloading-ad-absurdum.html)
- [Why Everyone Hates Operator Overloading](http://blog.jooq.org/2014/02/10/why-everyone-hates-operator-overloading)
